
<DMCControllerSetting>:
     orientation: 'vertical'
     canvas.before:
          Color:
               rgb: .6, .6, .6
          Rectangle:
               pos: self.pos
               size: self.size
     SomeMenu_ActionBar:
          id: ActionBar
     ScreenManager:
          id: sm
          current: "setting_screen"
          SettingScreen:
          EdgePointScreen:
          RestPointScreen:
          StartPointScreen:
          ParameterScreen:
          ArrayScreen:
<SomeMenu_ActionBar@ActionBar>:
     ActionView:
          id: ActionView
          HiddenIcon_ActionPrevious:
          ActionGroup:
               id: App_ActionGroup
               mode: 'spinner'
               text: 'Go to Setting'

               ActionButton:
                    text: 'Setting'
                    on_release: app.root.ids.sm.current = 'setting_screen'
               ActionButton:
                    text: 'Edge Point'
                    on_release:  app.root.ids.sm.current = 'edgepoint_screen'
               ActionButton:
                    text: 'Rest Point'
                    on_release:  app.root.ids.sm.current = 'restpoint_screen'
               ActionButton:
                    text: 'Start Point'
                    on_release: app.root.ids.sm.current = 'startpoint_screen'
               ActionButton:
                    text: 'Parameter'
                    on_release:  app.root.ids.sm.current = 'parameter_screen'
               ActionButton:
                    text: 'Array'
                    on_release:  app.root.ids.sm.current = 'array_screen'

          ActionGroup:
               id: App_ActionGroup2
               mode: 'spinner'
               text: 'App'

               ActionButton:
                    text: 'Settings'
                    on_press: app.open_settings()
               ActionButton:
                    text: 'Quit'
                    on_press: app.get_running_app().stop()

          ActionGroup:
               id: File_ActionGroup3
               mode: 'spinner'
               text: 'File'
               ActionButton:
                    text: 'Open'
               ActionButton:
                    text: 'Save'
          ActionButton:
               text: 'Disconnect'#TODO: Implement Disconnect
               on_press: root.disconnectAndRefresh()
          ActionSeparator:
          ActionButton:
               text: '  E-STOP  '#TODO: Implement ESTOP
               background_normal: ''
               background_color: [.72, .14, .14, 1]
               on_press: root.eStop()
          ActionPrevious:
               id: avTitle
               with_previous: False
               title: 'Controller Setting'

<HiddenIcon_ActionPrevious@ActionPrevious>:
     title: ''   # app.title if app.title is not None else 'Action Previous'
     with_previous: False
     app_icon: ''
     app_icon_width: 0
     app_icon_height: 0
     size_hint_x: None
     width: len(self.title) * 10

<SettingScreen>:
     name: 'setting_screen'
     Label:
          text: 'Setting Screen'
          font_size: sp(50)

<EdgePointScreen>:
     name: 'edgepoint_screen'
     Label:
          text: 'Edge Point Screen'

<RestPointScreen>:
     name: 'restpoint_screen'
     BoxLayout:
          orientation: 'vertical'
          Label:
               text: 'random'
               font_size: 50

          BoxLayout:
               Button:
                    text: 'Back to Setting'
                    font_size: 30
                    on_release: app.root.ids.sm.current = 'setting_screen'
               Button:
                    text: 'get random colour screen'
                    font_size: 30
                    on_release: app.root.ids.sm.current = 'setting_screen'
<StartPointScreen>:
     name: 'startpoint_screen'
     Label:
          text: 'Start Point Screen'
          font_size: sp(50)

<ParameterScreen>:
     name: 'parameter_screen'
     Label:
          text: 'Parameter Screen'
<ArrayScreen>:
     name: 'array_screen'
     array_name: 'arr'
     array_len: 130
     BoxLayout:
          orientation: 'vertical'
          spacing: '8dp'
          padding: '8dp'

     # Controls
          BoxLayout:
               size_hint_y: None
               height: '44dp'
               spacing: '8dp'
               Button:
                    text: 'Load from Controller'
                    on_release: root.load_from_controller()
               Button:
                    text: 'Copy left → inputs'
                    on_release: root.copy_current_to_inputs()
               Button:
                    text: 'Write to Controller'
                    on_release: root.write_to_controller()

     # Two columns
          BoxLayout:
               spacing: '12dp'
          # LEFT: controller values
               BoxLayout:
                    orientation: 'vertical'
                    size_hint_x: .5
                    Label:
                         size_hint_y: None
                         height: '24dp'
                         text: f"{root.array_name} (controller)"
                    ScrollView:
                         do_scroll_x: False
                    GridLayout:
                         id: left_grid
                         cols: 3          # [index][=][value]
                         size_hint_y: None
                         height: self.minimum_height
                         row_default_height: '28dp'
                         row_force_default: True

          # RIGHT: edit inputs
               BoxLayout:
                    orientation: 'vertical'
                    size_hint_x: .5
               Label:
                    size_hint_y: None
                    height: '24dp'
                    text: f"{root.array_name} (new values)"
               ScrollView:
                    do_scroll_x: False
                    GridLayout:
                         id: right_grid
                         cols: 2          # [index][TextInput]
                         size_hint_y: None
                         height: self.minimum_height
                         row_default_height: '28dp'
                         row_force_default: True